<!DOCTYPE html>
<html>
    <head>
        <title>Vr Community</title>
        <link rel="stylesheet" href="styleHomepage.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;1,100;1,800&display=swap" rel="stylesheet">
        <link rel="icon" href="immagini/VrIcon.png" type="image/x-icon">
    </head>
    <body>
        <nav>
			<ul>
				<li><a href="Homepage.html" class="casella" style="color: black;"><strong>Vr</strong></a> </li>
				<li><a href="Shop.html" class="casella">Shop</a></li>
                <li><a href="Carrello.html" class="casella">Carrello</a></li>
                <li><a href="Scopri.html" class="casella">Scopri di più</a></li>
				<li><a href="#" class="casella">Altro</a>
                    <ul class="dropdown">
                        <li><a href="Preferiti.html" class="casella">Preferiti</a></li>
                        <li><a href="Cronologia.html" class="casella">Cronologia</a></li>
                    </ul>
                </li>
                <li><a href="Profilo.html"><img src="immagini/utente.png" alt="profilo" id="profilo" class="profilo"></a></li>
			</ul>
		</nav>
        <br><br><br><br>
        
        <div class="container">
            <!-- Immagine principale -->
            <div class="main-image-container">
                <img src="immagini/startImg.jpg" class="startImg" alt="VR Community">
            </div>

            <!-- Sezione VR Brands -->
            <section class="section">
                <div class="section-header">
                    <a href="Vrbrands.html" class="section-link">
                        <img src="immagini/freccia.png" alt="freccia" class="freccia">
                        <h2 class="section-title">Vr brands</h2>
                    </a>
                </div>
                
                <div class="brands-grid">
                    <div class="brand-card">
                        <div class="brand-image-container">
                            <img src="immagini/meta.png" alt="Meta" class="brand-logo">
                        </div>
                        <h3 class="brand-name">Meta</h3>
                    </div>
                    
                    <div class="brand-card">
                        <div class="brand-image-container">
                            <img src="immagini/pico.png" alt="Pico" class="brand-logo">
                        </div>
                        <h3 class="brand-name">Pico</h3>
                    </div>
                    
                    <div class="brand-card">
                        <div class="brand-image-container">
                            <img src="immagini/psVr.png" alt="Playstation VR" class="brand-logo">
                        </div>
                        <h3 class="brand-name">Playstation Vr</h3>
                    </div>
                    
                    <div class="brand-card">
                        <div class="brand-image-container">
                            <img src="immagini/apple.png" alt="Apple" class="brand-logo">
                        </div>
                        <h3 class="brand-name">Apple</h3>
                    </div>
                </div>
            </section>

            <!-- Sezione Ricondizionati -->
            <section class="section">
                <div class="section-header">
                    <a href="Shop.html" class="section-link">
                        <img src="immagini/freccia.png" alt="freccia" class="freccia">
                        <h2 class="section-title">Ricondizionati</h2>
                    </a>
                </div>
                
                <div class="products-grid">
                    <div class="product-card">
                        <div class="product-image-container">
                            <img src="immagini/metaQ2.jpg" alt="Meta Quest 2" class="product-image">
                        </div>
                        <h3 class="product-name">Meta Quest 2</h3>
                    </div>
                    
                    <div class="product-card">
                        <div class="product-image-container">
                            <img src="immagini/pico4.png" alt="Pico 4" class="product-image">
                        </div>
                        <h3 class="product-name">Pico 4</h3>
                    </div>
                    
                    <div class="product-card">
                        <div class="product-image-container">
                            <img src="immagini/metaQ3.png" alt="Meta Quest 3" class="product-image">
                        </div>
                        <h3 class="product-name">Meta Quest 3</h3>
                    </div>
                    
                    <div class="product-card">
                        <div class="product-image-container">
                            <img src="immagini/pimaxC.png" alt="Pimax Crystal Light" class="product-image">
                        </div>
                        <h3 class="product-name">Pimax Crystal Light</h3>
                    </div>
                </div>
            </section>
        </div>
        <script>
                //let carrello = [];
                //let preferiti = [];
                //let cronologia = [];
                //localStorage.setItem("carrello", JSON.stringify(carrello));
                //localStorage.setItem("preferiti", JSON.stringify(preferiti));
                //localStorage.setItem("cronologia", JSON.stringify(cronologia));

                let datiDevice = [];
                let nomeFile = "datiDevices.csv";
                
                const img = document.getElementById('profilo');
                img.src = "immagini/" + localStorage.getItem("imgProfilo");

                fetch(nomeFile)
                    .then(response => response.text())
                    .then(risultato => {
                        // Divide il testo in righe
                        let righe = risultato.split('\n');
                        
                        for (let i = 1; i < righe.length; i++) {
                            let riga = righe[i].trim();
                            
                            // Salta righe vuote
                            if (riga === '') continue;
                            
                            // Divide la riga in campi
                            let campi = analizzaRigaCSV(riga);
                            
                            if (campi.length >= 12) {
                                let marca = campi[0];
                                let modello = campi[1];
                                let annoUscita = campi[2];
                                let memoria = campi[3];
                                let ram = campi[4];
                                let processore = campi[5];
                                let display = campi[6];
                                let risoluzione = campi[7];
                                let lenti = campi[8];
                                let tipo = campi[9];
                                let img = campi[10];
                                let prezzo = campi[11];
                                
                                let device = {
                                    Marca: marca,
                                    Modello: modello,
                                    AnnoUscita: annoUscita,
                                    Memoria: memoria,
                                    Ram: ram,
                                    Processore: processore,
                                    Display: display,
                                    Risoluzione: risoluzione,
                                    Lenti: lenti,
                                    Tipo: tipo,
                                    Img: img,
                                    Prezzo: prezzo
                                };
                                datiDevice.push(device);
                            }
                        }
                        localStorage.setItem("datiDevice", JSON.stringify(datiDevice));
                    })
                    .catch(error => console.error('Errore nel caricamento del file:', error));

                // Funzione per analizzare correttamente una riga CSV
                    function analizzaRigaCSV(riga) {
                        const campiEstratti = [];       // Array per i campi trovati
                        let campoInCorso = '';          // Campo che stiamo costruendo
                        let dentroVirgolette = false;   // Flag per sapere se siamo tra virgolette
                        
                        // Esamina ogni carattere della riga
                        for (let posizione = 0; posizione < riga.length; posizione++) {
                            const carattereCorrente = riga[posizione];
                            
                            // Controlla se il carattere è una virgoletta
                            if (carattereCorrente === '"') {
                                // Se siamo tra virgolette e c'è un'altra virgoletta subito dopo
                                if (dentroVirgolette && posizione + 1 < riga.length && riga[posizione + 1] === '"') {
                                    campoInCorso += '"';         // Aggiungi virgoletta singola
                                    posizione++;                  // Salta la prossima virgoletta
                                } else {
                                    // Attiva/disattiva la modalità "tra virgolette"
                                    dentroVirgolette = !dentroVirgolette;
                                }
                            } 
                            // Controlla se il carattere è una virgola separatrice
                            else if (carattereCorrente === ',' && !dentroVirgolette) {
                                campiEstratti.push(campoInCorso); // Salva il campo completo
                                campoInCorso = '';                // Ricomincia nuovo campo
                            } 
                            // Qualsiasi altro carattere
                            else {
                                campoInCorso += carattereCorrente; // Aggiungi al campo corrente
                            }
                        }
                        
                        // Per non dimentica l'ultimo campo dopo l'ultima virgola
                        campiEstratti.push(campoInCorso);
                        
                        return campiEstratti;
                    }
        </script>
    </body>
</html>